---
# Crear un VDC
- name: Create Org VDC
  community.vmware.vmware_vcd_vdc:
    hostname: "{{ vcd_hostname }}"
    username: "{{ vcd_username }}"
    password: "{{ vcd_password }}"
    org_name: "{{ org_name }}"
    vdc_name: "{{ vdc_name }}"
    provider_vdc_name: "{{ provider_vdc }}"
    allocation_model: "ReservationPool"
    storage_profile: "{{ storage_profile }}"
    state: present
  delegate_to: localhost

# Añadir política de colocación
- name: Add Placement Policy
  community.vmware.vmware_vcd_vdc:
    hostname: "{{ vcd_hostname }}"
    username: "{{ vcd_username }}"
    password: "{{ vcd_password }}"
    org_name: "{{ org_name }}"
    vdc_name: "{{ vdc_name }}"
    placement_policy: "{{ placement_policy }}"
    state: update
  delegate_to: localhost

# Añadir política de dimensionamiento
- name: Add Sizing Policy
  community.vmware.vmware_vcd_vdc:
    hostname: "{{ vcd_hostname }}"
    username: "{{ vcd_username }}"
    password: "{{ vcd_password }}"
    org_name: "{{ org_name }}"
    vdc_name: "{{ vdc_name }}"
    sizing_policy: "{{ sizing_policy }}"
    state: update
  delegate_to: localhost

# Metadata Trial Mode
- name: Set Trial Mode Metadata
  community.vmware.vmware_vcd_metadata:
    hostname: "{{ vcd_hostname }}"
    username: "{{ vcd_username }}"
    password: "{{ vcd_password }}"
    org_name: "{{ org_name }}"
    vdc_name: "{{ vdc_name }}"
    key: "TrialMode"
    value: "true"
    type: "STRING"
  delegate_to: localhost
